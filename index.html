<!DOCTYPE html>
<html>
<head>
    <title>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏°‡∏ô‡∏ó‡πå</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 100vh; width: 100%; } /* ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ */
        .info-box {
            position: absolute; bottom: 20px; left: 10px; right: 10px;
            background: white; padding: 10px; border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2); z-index: 1000;
            text-align: center; font-family: sans-serif;
        }
    </style>
</head>
<body>

    <div id="map"></div>
    <div class="info-box">
        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á</strong><br>
        <span id="van1-status">üöê ‡∏£‡∏ñ‡∏Ñ‡∏±‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</span><br>
        </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // 1. ‡∏ß‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏°)
        const firebaseConfig = {
            apiKey: "AIzaSyBL4nhltSeXZTtgShoqgvWG4tcyb92XOzw",
            authDomain: "my-apartment-shuttle.firebaseapp.com",
            databaseURL: "https://my-apartment-shuttle-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "my-apartment-shuttle",
            storageBucket: "my-apartment-shuttle.firebasestorage.app",
            messagingSenderId: "808566202899",
            appId: "1:808566202899:web:5626ae23c0df6335d455e6"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡∏≠‡∏ô‡∏∏‡∏™‡∏≤‡∏ß‡∏£‡∏µ‡∏¢‡πå‡∏ä‡∏±‡∏¢‡∏Ø - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏´‡∏≠‡∏û‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
        const map = L.map('map').setView([13.7649, 100.5383], 15);

        // ‡πÉ‡∏ä‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏£‡∏µ‡∏à‡∏≤‡∏Å OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö Marker ‡∏£‡∏ñ
        let van1Marker = null;

        // ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏£‡∏ñ‡∏ï‡∏π‡πâ (‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ü‡∏£‡∏µ‡∏à‡∏≤‡∏Å‡πÄ‡∏ô‡πá‡∏ï ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô url ‡πÑ‡∏î‡πâ)
        const vanIcon = L.icon({
            iconUrl: 'https://cdn-icons-png.flaticon.com/512/3066/3066259.png', // ‡∏£‡∏π‡∏õ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏£‡∏ñ
            iconSize: [40, 40], 
            iconAnchor: [20, 20]
        });

        // 3. ‡∏ü‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase (Realtime!)
        db.ref('shuttles/van1').on('value', (snapshot) => {
            const data = snapshot.val();
            
            if (data && data.active) {
                // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏ñ Active
                const lat = data.lat;
                const lng = data.lng;

                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Marker ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                if (!van1Marker) {
                    van1Marker = L.marker([lat, lng], {icon: vanIcon}).addTo(map)
                        .bindPopup("‡∏£‡∏ñ‡∏Ñ‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ");
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (Slide)
                    van1Marker.setLatLng([lat, lng]);
                }
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                document.getElementById('van1-status').innerText = "üöê ‡∏£‡∏ñ‡∏Ñ‡∏±‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πà‡∏á";
                document.getElementById('van1-status').style.color = "green";
                
                // ‡∏Ç‡∏¢‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏£‡∏ñ (Optional: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡∏•‡∏≠‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ)
                map.panTo([lat, lng]);

            } else {
                // ‡∏ñ‡πâ‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏¥‡πà‡∏á
                 document.getElementById('van1-status').innerText = "üöê ‡∏£‡∏ñ‡∏Ñ‡∏±‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏à‡∏≠‡∏î/‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå";
                 document.getElementById('van1-status').style.color = "red";
            }
        });
    </script>
</body>
</html>